<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" xmlns:media="http://search.yahoo.com/mrss/"><channel><title>DB on こぴぺたん ログ</title><link>https://c-a-p-engineer.github.io/tags/db/</link><description>Recent content in DB on こぴぺたん ログ</description><generator>Hugo -- gohugo.io</generator><language>ja</language><copyright>&amp;copy;{year}, All Rights Reserved</copyright><lastBuildDate>Sun, 05 Oct 2025 09:00:00 +0900</lastBuildDate><atom:link href="https://c-a-p-engineer.github.io/tags/db/index.xml" rel="self" type="application/rss+xml"/><item><title>MySQL の SYSDATE() と NOW() の違いを整理する</title><link>https://c-a-p-engineer.github.io/tech/2025/10/05/mysql-sysdate-vs-now/</link><pubDate>Sun, 05 Oct 2025 09:00:00 +0900</pubDate><atom:modified>Sun, 05 Oct 2025 09:00:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2025/10/05/mysql-sysdate-vs-now/</guid><description>&lt;h1 id="mysql-の-sysdate-と-now-の違いを整理する">MySQL の SYSDATE() と NOW() の違いを整理する&lt;/h1>
&lt;p>MySQLで現在日時を取得する代表的な関数は &lt;code>SYSDATE()&lt;/code> と &lt;code>NOW()&lt;/code> の2つです。一見同じ値を返しそうですが、評価タイミングやレプリケーションとの相性が異なります。本稿ではそれぞれの挙動と使い分けの指針をまとめます。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Mysql】コマンドラインで入力中だったものを終了させる方法</title><link>https://c-a-p-engineer.github.io/tech/2022/12/08/mysql-cli-abort/</link><pubDate>Thu, 08 Dec 2022 18:00:00 +0900</pubDate><atom:modified>Thu, 08 Dec 2022 18:00:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/12/08/mysql-cli-abort/</guid><description>&lt;h1 id="mysqlコマンドラインで入力中だったものを終了させる方法">【Mysql】コマンドラインで入力中だったものを終了させる方法&lt;/h1>
&lt;p>Mysql でコマンドラインでtypoしたりして入力中だったものを途中で終了させる方法&lt;/p>
&lt;h2 id="途中終了させる方法">途中終了させる方法&lt;/h2>
&lt;p>Mysql のコマンドラインで途中終了させるには &lt;code>\c&lt;/code> を入力すると終了します。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Mysql】DBが存在することを確認する方法</title><link>https://c-a-p-engineer.github.io/tech/2022/10/23/mysql-show-database/</link><pubDate>Sun, 23 Oct 2022 05:30:00 +0900</pubDate><atom:modified>Sun, 23 Oct 2022 05:30:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/10/23/mysql-show-database/</guid><description>&lt;h1 id="mysqldbが存在することを確認する方法">【Mysql】DBが存在することを確認する方法&lt;/h1>
&lt;p>Mysql でDBが存在することを確認する方法&lt;/p>
&lt;h2 id="db一覧">DB一覧&lt;/h2>
&lt;p>すべてのDBを出力する&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="k">SHOW&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">DATABASES&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="dbを指定する">DBを指定する&lt;/h2>
&lt;p>DB名を指定して存在を確認する&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="k">SHOW&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">DATABASES&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">LIKE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;[DB名]&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="ワイルドカードを使用する">ワイルドカードを使用する&lt;/h3>
&lt;p>普通のLIKEと同様に &lt;code>%&lt;/code> を使用して前方一致検索などが可能です。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Mysql】外部キー制約を無効化する方法</title><link>https://c-a-p-engineer.github.io/tech/2022/10/20/mysql-foreign_key_checks/</link><pubDate>Thu, 20 Oct 2022 18:00:00 +0900</pubDate><atom:modified>Thu, 20 Oct 2022 18:00:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/10/20/mysql-foreign_key_checks/</guid><description>&lt;h1 id="mysql外部キー制約を無効化する方法">【Mysql】外部キー制約を無効化する方法&lt;/h1>
&lt;p>Mysql でテーブルやデータを削除する時に外部キーのせいで簡単に出来ない時がそれを解決するために外部キー制約を無効化する方法&lt;/p>
&lt;h2 id="外部キー制約を無効化">外部キー制約を無効化&lt;/h2>
&lt;p>以下のコマンドを使用すると外部キーチェックを無効化ができます。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Mysql】大量のスロークエリログを簡単に解析できる mysqldumpslow</title><link>https://c-a-p-engineer.github.io/tech/2022/10/18/mysql-mysqldumpslow/</link><pubDate>Tue, 18 Oct 2022 18:00:00 +0900</pubDate><atom:modified>Tue, 18 Oct 2022 18:00:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/10/18/mysql-mysqldumpslow/</guid><description>&lt;h1 id="mysqlスロークエリを簡単に解析できる-mysqldumpslow">【Mysql】スロークエリを簡単に解析できる mysqldumpslow&lt;/h1>
&lt;p>Mysql のスロークエリログを簡単に解析できる mysqldumpslow を使ってみる。&lt;/p>
&lt;h2 id="mysqldumpslow">mysqldumpslow&lt;/h2>
&lt;p>&lt;code>mysqldumpslow&lt;/code> コマンドを使用することで大量のスロークエリログを簡単に解析できます。&lt;/p>
&lt;h3 id="インストール">インストール&lt;/h3>
&lt;p>&lt;code>mysqldumpslow&lt;/code> コマンドを使用するにには &lt;code>mysql-server&lt;/code> のインストールが必要なようです。&lt;br />
僕は面倒なので mysql のコンテナを使用しました。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Mysql】ERROR 1248 (42000): Every derived table must have its own alias エラーの解決</title><link>https://c-a-p-engineer.github.io/tech/2022/10/15/mysql-own-ailias/</link><pubDate>Sat, 15 Oct 2022 16:00:00 +0900</pubDate><atom:modified>Sat, 15 Oct 2022 16:00:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/10/15/mysql-own-ailias/</guid><description>&lt;h1 id="mysqlerror-1248-42000-every-derived-table-must-have-its-own-alias-エラーの解決">【Mysql】ERROR 1248 (42000): Every derived table must have its own alias エラーの解決&lt;/h1>
&lt;p>Mysql &lt;code>ERROR 1248 (42000): Every derived table must have its own alias&lt;/code> エラーの解決メモ&lt;/p>
&lt;h2 id="エラー">エラー&lt;/h2>
&lt;p>以下のようなSQLを実行すると &lt;code>ERROR 1248 (42000): Every derived table must have its own alias&lt;/code> が出てしまいます。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Mysql】連続した日付の表を作る</title><link>https://c-a-p-engineer.github.io/tech/2022/10/14/mysql-date-sequence/</link><pubDate>Fri, 14 Oct 2022 01:50:00 +0900</pubDate><atom:modified>Fri, 14 Oct 2022 01:50:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/10/14/mysql-date-sequence/</guid><description>&lt;h1 id="mysql連続した日付の表を作る">【Mysql】連続した日付の表を作る&lt;/h1>
&lt;p>Mysql で 連続した日付の表を作る方法&lt;/p>
&lt;h2 id="sqlを実行する">SQLを実行する&lt;/h2>
&lt;p>以下のSQLを使用すると &lt;code>2022-10-14&lt;/code> と &lt;code>2022-10-13&lt;/code> の仮想表が作られます。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="k">SELECT&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;2022-10-14&amp;#39;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">INTERVAL&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="n">seq_no&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">DAY&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">AS&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">date&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">-- 開始日
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="n">seq_no&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="n">seq_no&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">AS&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">SEQ&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">-- シーケンスNo
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">FROM&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">information_schema&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">COLUMNS&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">SELECT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="n">seq_no&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">as&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">-- 変数の初期化
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">WHERE&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="n">seq_no&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;lt;=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">DATEDIFF&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;2022-10-14&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;2022-10-13&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">-- 開始日 - 終了日 の差+1日数分を表示
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>結果は以下のようになります。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Docker】SchemaSpy（スキームスパイ） を使って自動的にER図を生成する（2022/10/10 改良版</title><link>https://c-a-p-engineer.github.io/tech/2022/10/10/docker-schemaspy/</link><pubDate>Mon, 10 Oct 2022 16:30:00 +0900</pubDate><atom:modified>Mon, 10 Oct 2022 16:30:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/10/10/docker-schemaspy/</guid><description>&lt;h1 id="dockerschemaspyスキームスパイ-を使って自動的にer図を生成する改良版">【Docker】SchemaSpy（スキームスパイ） を使って自動的にER図を生成する（改良版&lt;/h1>
&lt;p>Docker で SchemaSpy（スキームスパイ） を使って自動的にER図を生成する。（改良版&lt;br />
以前書いた記事（&lt;a href="tech/2022/03/31/docker-schemaspy/" target="_blank" rel="nofollow noopener">【Docker】SchemaSpy を使って自動的にER図を生成する&lt;/a>）がSchemaSpyのアップデートのためか動作がおかしくなったため改良版を書きました。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/docker.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Docker</category><category>DB</category><category>Docker</category></item><item><title>【Mysql】UNIXタイムスタンプ &lt;=> 日時 変換方法</title><link>https://c-a-p-engineer.github.io/tech/2022/10/04/mysql-unixtime-convert/</link><pubDate>Tue, 04 Oct 2022 01:20:00 +0900</pubDate><atom:modified>Tue, 04 Oct 2022 01:20:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/10/04/mysql-unixtime-convert/</guid><description>&lt;h1 id="mysqlunixタイムスタンプ--日時-変換方法">【Mysql】UNIXタイムスタンプ &amp;lt;=&amp;gt; 日時 変換方法&lt;/h1>
&lt;p>UNIXタイムスタンプ &amp;lt;=&amp;gt; 日時 変換方法メモ&lt;/p>
&lt;h2 id="日時--unixタイムスタンプ">日時 =&amp;gt; UNIXタイムスタンプ&lt;/h2>
&lt;p>&lt;code>UNIX_TIMESTAMP&lt;/code> に日時を入れるとUNIXタイムスタンプに変換されます。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="k">SELECT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">UNIX_TIMESTAMP&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;2022/10/04 01:20:00&amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="unixタイムスタンプ--日時">UNIXタイムスタンプ =&amp;gt; 日時&lt;/h2>
&lt;p>&lt;code>FROM_UNIXTIME&lt;/code> にUNIXタイムスタンプを入れると日時に変換されます。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Mysql】mysqlコマンドから直接SQLを実行する</title><link>https://c-a-p-engineer.github.io/tech/2022/09/22/mysql-command-execute/</link><pubDate>Thu, 22 Sep 2022 18:00:00 +0900</pubDate><atom:modified>Thu, 22 Sep 2022 18:00:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/09/22/mysql-command-execute/</guid><description>&lt;h1 id="mysqlmysqlコマンドから直接sqlを実行する">【Mysql】mysqlコマンドから直接SQLを実行する&lt;/h1>
&lt;p>Mysql で mysqlコマンドから直接SQLを実行するメモ&lt;/p>
&lt;h2 id="sqlを実行する">SQLを実行する&lt;/h2>
&lt;p>以下の &lt;code>[SQL]&lt;/code> の部分に実行したいSQLを入れてください。&lt;/p>
&lt;pre tabindex="0">&lt;code>mysql -u[UserName] -p[Password] [DatabaseNmae] -e&amp;#34;[SQL]&amp;#34;
&lt;/code>&lt;/pre>&lt;h3 id="実行サンプル">実行サンプル&lt;/h3>
&lt;p>以下のようにするとテーブル一覧を出力してくれます。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Mysql】mysqlコマンドを実行する際、パスワードに記号が入っている際の対応方法</title><link>https://c-a-p-engineer.github.io/tech/2022/09/22/mysql-command-password-escape/</link><pubDate>Thu, 22 Sep 2022 18:00:00 +0900</pubDate><atom:modified>Thu, 22 Sep 2022 18:00:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/09/22/mysql-command-password-escape/</guid><description>&lt;h1 id="mysqlmysqlコマンドを実行する際にパスワードに記号が入っている際の対応方法">【Mysql】mysqlコマンドを実行する際にパスワードに記号が入っている際の対応方法&lt;/h1>
&lt;p>Mysql で mysqlコマンドを実行する際、パスワードに記号が入っている際の対応方法メモ。&lt;/p>
&lt;h2 id="パスワードに記号が入っている">パスワードに記号が入っている&lt;/h2>
&lt;p>mysqlコマンドを実行する際、パスワードに記号が入ってると以下のようにエラーが発生します。&lt;br />
パスワードには &lt;code>p@ssword&lt;/code> としています。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Mysql】実行中のプロセスを検索する</title><link>https://c-a-p-engineer.github.io/tech/2022/09/21/mysql-processlist-search/</link><pubDate>Wed, 21 Sep 2022 18:00:00 +0900</pubDate><atom:modified>Wed, 21 Sep 2022 18:00:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/09/21/mysql-processlist-search/</guid><description>&lt;h1 id="mysql長時間実行しているプロセスを確認する">【Mysql】長時間実行しているプロセスを確認する&lt;/h1>
&lt;p>&lt;code>processlist&lt;/code> を使用し実行中のプロセスを見ることができますが、プロセス数が多いと対象のプロセスを探すのが困難になりますがそんなプロセスを確認する方法。&lt;/p>
&lt;h2 id="プロセスを検索する方法">プロセスを検索する方法&lt;/h2>
&lt;p>&lt;code>information_schema.PROCESSLIST&lt;/code> に対して &lt;code>select&lt;/code> する事でプロセスの検索が可能です。&lt;br />
※ &lt;code>SHOW FULL PROCESSLIST&lt;/code> と &lt;code>SELECT * FROM INFORMATION_SCHEMA.PROCESSLIST&lt;/code> は同等の結果になります。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Mysql】ERROR 1136 (21S01): Column count doesn't match value count at row のエラー解決方法</title><link>https://c-a-p-engineer.github.io/tech/2022/09/16/mysql-column-dosent-match/</link><pubDate>Sat, 17 Sep 2022 17:00:00 +0900</pubDate><atom:modified>Sat, 17 Sep 2022 17:00:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/09/16/mysql-column-dosent-match/</guid><description>&lt;h1 id="mysqlerror-1136-21s01-column-count-doesnt-match-value-count-at-row-エラーの解決">【Mysql】ERROR 1136 (21S01): Column count doesn&amp;rsquo;t match value count at row エラーの解決&lt;/h1>
&lt;p>Mysql &lt;code>ERROR 1136 (21S01): Column count doesn't match value count at row&lt;/code> エラーの解決メモ&lt;/p>
&lt;h2 id="原因">原因&lt;/h2>
&lt;p>INSERTに指定された列と値の数と一致しないのが原因です。&lt;/p>
&lt;h2 id="解決方法">解決方法&lt;/h2>
&lt;p>列数と値の数を一致させる。&lt;br />
そのためINSERT文の指定した列と値に過不足があるか見直しをすれば解決します。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Mysql】指定したパーティションのみを検索する</title><link>https://c-a-p-engineer.github.io/tech/2022/09/15/mysql-partition-select/</link><pubDate>Fri, 16 Sep 2022 18:00:00 +0900</pubDate><atom:modified>Fri, 16 Sep 2022 18:00:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/09/15/mysql-partition-select/</guid><description>&lt;h1 id="mysql指定したパーティションのみを検索する">【Mysql】指定したパーティションのみを検索する&lt;/h1>
&lt;p>Mysqlで指定したパーティションのみを検索する方法メモ。&lt;/p>
&lt;h2 id="パーティションを指定して検索する">パーティションを指定して検索する&lt;/h2>
&lt;p>以下の方法で指定したパーティションのみの検索が可能です。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="k">SELECT&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">FROM&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="k">TABLE_NAME&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">PARTITION&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="n">PARTITION_NAME&lt;/span>&lt;span class="p">]);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="サンプルテーブルの作成">サンプルテーブルの作成&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="k">CREATE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">TABLE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">`&lt;/span>&lt;span class="n">sample&lt;/span>&lt;span class="o">`&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">`&lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="o">`&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">bigint&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">20&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">unsigned&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NOT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NULL&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">AUTO_INCREMENT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">`&lt;/span>&lt;span class="n">num&lt;/span>&lt;span class="o">`&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">decimal&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">DEFAULT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NOT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NULL&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">PRIMARY&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">KEY&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">`&lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="o">`&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">`&lt;/span>&lt;span class="n">num&lt;/span>&lt;span class="o">`&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">ENGINE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">InnoDB&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">DEFAULT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">CHARSET&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">utf8mb4&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">PARTITION&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">BY&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">RANGE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">FLOOR&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">`&lt;/span>&lt;span class="n">num&lt;/span>&lt;span class="o">`&lt;/span>&lt;span class="p">))(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">PARTITION&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">p0&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">VALUES&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">LESS&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">THAN&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">PARTITION&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">p1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">VALUES&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">LESS&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">THAN&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">20&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">PARTITION&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">p2&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">VALUES&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">LESS&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">THAN&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">30&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">PARTITION&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">p3&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">VALUES&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">LESS&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">THAN&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">MAXVALUE&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="データを入れる">データを入れる&lt;/h3>
&lt;p>作成したテーブルにデータを入れてみます。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Mysql】テーブル更新時間を確認する</title><link>https://c-a-p-engineer.github.io/tech/2022/08/12/mysql-update-log/</link><pubDate>Fri, 12 Aug 2022 18:30:00 +0900</pubDate><atom:modified>Fri, 12 Aug 2022 18:30:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/08/12/mysql-update-log/</guid><description>&lt;h1 id="mysqlテーブル更新時間を確認する">【Mysql】テーブル更新時間を確認する&lt;/h1>
&lt;p>Mysql でテーブル更新時間を確認する方法メモ。&lt;br />
Mysql で該当のテーブルが使われているか確認したいと思い、更新されている値を取得する方法を探しました。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Mysql】ERROR 1526 (HY000): Table has no partition for value エラーの解決</title><link>https://c-a-p-engineer.github.io/tech/2022/06/15/mysql-has-no-partition/</link><pubDate>Wed, 15 Jun 2022 12:30:00 +0900</pubDate><atom:modified>Wed, 15 Jun 2022 12:30:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/06/15/mysql-has-no-partition/</guid><description>&lt;h1 id="error-1526-hy000-table-has-no-partition-for-value-エラーの解決">ERROR 1526 (HY000): Table has no partition for value エラーの解決&lt;/h1>
&lt;p>Mysql &lt;code>ERROR 1526 (HY000): Table has no partition for value&lt;/code> エラーの解決メモ&lt;/p>
&lt;h2 id="原因">原因&lt;/h2>
&lt;p>パーティションの範囲外の値が指定されている。&lt;/p>
&lt;h2 id="解決方法">解決方法&lt;/h2>
&lt;p>パーティションの範囲の範囲を増やすことで対応できます。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Mysql】ERROR 1503 (HY000): A PRIMARY KEY must include all columns in the table's partitioning function エラーの解決</title><link>https://c-a-p-engineer.github.io/tech/2022/06/10/mysql-primary-partitioning/</link><pubDate>Fri, 10 Jun 2022 03:30:00 +0900</pubDate><atom:modified>Fri, 10 Jun 2022 03:30:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/06/10/mysql-primary-partitioning/</guid><description>&lt;h1 id="mysqlerror-1503-hy000-a-primary-key-must-include-all-columns-in-the-tables-partitioning-function-エラーの解決">【Mysql】ERROR 1503 (HY000): A PRIMARY KEY must include all columns in the table&amp;rsquo;s partitioning function エラーの解決&lt;/h1>
&lt;p>Mysql &lt;code>ERROR 1503 (HY000): A PRIMARY KEY must include all columns in the table's partitioning function&lt;/code> エラーの解決メモ&lt;/p>
&lt;h2 id="原因">原因&lt;/h2>
&lt;p>パーティショニングを行う列はプライマリキーに含めていないため。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Mysql】ERROR 1564 (HY000): This partition function is not allowed エラーの解決</title><link>https://c-a-p-engineer.github.io/tech/2022/06/10/mysql-partition-function-not-allowed/</link><pubDate>Fri, 10 Jun 2022 03:30:00 +0900</pubDate><atom:modified>Fri, 10 Jun 2022 03:30:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/06/10/mysql-partition-function-not-allowed/</guid><description>&lt;h1 id="mysqlerror-1564-hy000-this-partition-function-is-not-allowed-エラーの解決">【Mysql】ERROR 1564 (HY000): This partition function is not allowed エラーの解決&lt;/h1>
&lt;p>Mysql &lt;code>ERROR 1564 (HY000): This partition function is not allowed&lt;/code> エラーの解決メモ&lt;/p>
&lt;h2 id="原因">原因&lt;/h2>
&lt;p>パーティション設定時に使用できる関数以外が指定されている。&lt;/p>
&lt;h2 id="解決方法">解決方法&lt;/h2>
&lt;p>パーティショニングを行う際には以下のリンクの関数を使用する。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Mysql】ERROR 1659 (HY000): Field 'num' is of a not allowed type for this type of partitioning エラーの解決</title><link>https://c-a-p-engineer.github.io/tech/2022/06/10/mysql-not-allowed-type-partitioning/</link><pubDate>Fri, 10 Jun 2022 03:30:00 +0900</pubDate><atom:modified>Fri, 10 Jun 2022 03:30:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/06/10/mysql-not-allowed-type-partitioning/</guid><description>&lt;h1 id="mysqlerror-1659-hy000-field-num-is-of-a-not-allowed-type-for-this-type-of-partitioning-エラーの解決">【Mysql】ERROR 1659 (HY000): Field &amp;rsquo;num&amp;rsquo; is of a not allowed type for this type of partitioning エラーの解決&lt;/h1>
&lt;p>Mysql &lt;code>ERROR 1659 (HY000): Field 'num' is of a not allowed type for this type of partitioning&lt;/code> エラーの解決メモ&lt;/p>
&lt;h2 id="原因">原因&lt;/h2>
&lt;p>列がパーティションに指定できる型ではない。&lt;/p>
&lt;h2 id="解決方法">解決方法&lt;/h2>
&lt;p>解決方法は2つ。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Mysql】ERROR 1659 (HY000): The PARTITION function returns the wrong type エラーの解決</title><link>https://c-a-p-engineer.github.io/tech/2022/06/10/mysql-partition-returns-wrong-type/</link><pubDate>Fri, 10 Jun 2022 03:30:00 +0900</pubDate><atom:modified>Fri, 10 Jun 2022 03:30:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/06/10/mysql-partition-returns-wrong-type/</guid><description>&lt;h1 id="mysqlerror-1564-hy000-the-partition-function-returns-the-wrong-type-エラーの解決">【Mysql】ERROR 1564 (HY000): The PARTITION function returns the wrong type エラーの解決&lt;/h1>
&lt;p>Mysql &lt;code>ERROR 1564 (HY000): The PARTITION function returns the wrong type&lt;/code> エラーの解決メモ&lt;/p>
&lt;h2 id="原因">原因&lt;/h2>
&lt;p>パーティション設定時に使用した関数の返却値の型がパーティションに設定できる型ではない。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Mysql】float, double型でテーブルのパーティションが切れない</title><link>https://c-a-p-engineer.github.io/tech/2022/06/10/mysql-partition-float-double/</link><pubDate>Fri, 10 Jun 2022 03:00:00 +0900</pubDate><atom:modified>Fri, 10 Jun 2022 03:00:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/06/10/mysql-partition-float-double/</guid><description>&lt;h1 id="mysqlfloat-double型でテーブルのパーティションが切れない">【Mysql】float, double型でテーブルのパーティションが切れない&lt;/h1>
&lt;p>Mysql で float, double型でテーブルのパーティションが切れなかったため解決した方法のメモ&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://dev.mysql.com/doc/refman/8.0/ja/partitioning-columns.html" target="_blank" rel="nofollow noopener">MySQL :: MySQL 8.0 リファレンスマニュアル :: 24.2.3 COLUMNS パーティショニング&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="パーティショニング可能な型">パーティショニング可能な型&lt;/h2>
&lt;p>以下がパーティショニング可能な型になります。&lt;br />
これ以外は &lt;strong>基本的には使用できません&lt;/strong>。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Mysql】テーブルの件数を取得する際に TABLE_ROWS と COUNT の違いの注意点</title><link>https://c-a-p-engineer.github.io/tech/2022/05/21/mysql-table-row/</link><pubDate>Sat, 21 May 2022 05:30:00 +0900</pubDate><atom:modified>Sat, 21 May 2022 05:30:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/05/21/mysql-table-row/</guid><description>&lt;h1 id="mysqlテーブルの件数を取得する際に-table_rows-と-count-の違いの注意点">【Mysql】テーブルの件数を取得する際に TABLE_ROWS と COUNT の違いの注意点&lt;/h1>
&lt;p>テーブルのデータ量が多く、COUNT だと時間が掛かるため、&lt;code>INFORMATION_SCHEMATABLES.TABLE_ROWS&lt;/code> から件数を確認してみたのですが、これが実際の件数と違うので注意が必要です。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Mysql】CREATE TABLE はトランザクションが効かないで暗黙的にコミットされる</title><link>https://c-a-p-engineer.github.io/tech/2022/05/07/mysql-create-table-transaction/</link><pubDate>Sat, 07 May 2022 02:00:00 +0900</pubDate><atom:modified>Sat, 07 May 2022 02:00:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/05/07/mysql-create-table-transaction/</guid><description>&lt;h1 id="mysqlcreate-table-はトランザクションが効かないで暗黙的にコミットされる">【Mysql】CREATE TABLE はトランザクションが効かないで暗黙的にコミットされる&lt;/h1>
&lt;p>Mysqlでは &lt;code>CREATE TABLE&lt;/code> はトランザクションが効かないで暗黙的にコミットされる。&lt;/p>
&lt;p>一部のステートメントでは暗黙的にコミットされトランザクションが効かなくなるとのことです。&lt;br />
&lt;a href="https://dev.mysql.com/doc/refman/8.0/ja/implicit-commit.html" target="_blank" rel="nofollow noopener">MySQL :: MySQL 8.0 リファレンスマニュアル :: 13.3.3 暗黙的なコミットを発生させるステートメント&lt;/a>&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Mysql】#hy000you can't specify target table 'hoge' for update in from clause の解決方法</title><link>https://c-a-p-engineer.github.io/tech/2022/04/10/mysq-cant-specify-target-table/</link><pubDate>Sun, 10 Apr 2022 02:30:00 +0900</pubDate><atom:modified>Sun, 10 Apr 2022 02:30:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/04/10/mysq-cant-specify-target-table/</guid><description>&lt;h1 id="mysqlhy000you-cant-specify-target-table-hoge-for-update-in-from-clause-の解決方法">【Mysql】#hy000you can&amp;rsquo;t specify target table &amp;lsquo;hoge&amp;rsquo; for update in from clause の解決方法&lt;/h1>
&lt;p>MysqlでSQLを実行したら&lt;code>#hy000you can't specify target table 'hoge' for update in from clause&lt;/code> というエラーが出たので解決方法メモ。&lt;/p>
&lt;h2 id="エラー">エラー&lt;/h2>
&lt;p>以下のようなSQLを実行すると &lt;code>#hy000you can't specify target table 'hoge' for update in from clause&lt;/code> というエラーが出てきます。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>【Docker】SchemaSpy を使って自動的にER図を生成する</title><link>https://c-a-p-engineer.github.io/tech/2022/03/31/docker-schemaspy/</link><pubDate>Thu, 31 Mar 2022 02:30:00 +0900</pubDate><atom:modified>Mon, 10 Oct 2022 16:30:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2022/03/31/docker-schemaspy/</guid><description>&lt;h1 id="dockerschemaspy-を使って自動的にer図を生成する">【Docker】SchemaSpy を使って自動的にER図を生成する&lt;/h1>
&lt;p>Docker で SchemaSpy を使って自動的にER図を生成する。&lt;/p>
&lt;div class="notices warning" data-title="Warning">
&lt;strong>注意&lt;/strong>&lt;br />
※2022/10/10追記&lt;br />
この記事の内容が動作しなくなっています。&lt;br />
&lt;a href="https://c-a-p-engineer.github.io/tech/2022/10/10/docker-schemaspy/" target="_blank" rel="nofollow noopener">【Docker】SchemaSpy を使って自動的にER図を生成する（2022/10/10 改良版&lt;/a> を見てください。
&lt;/div>
&lt;h2 id="docker-compose">docker-compose&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yml:docker-compose.yml" data-lang="yml:docker-compose.yml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;3&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">services&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">mysql&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">container_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">mysql&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">mysql:5.7&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- --&lt;span class="l">sql-mode=NO_ENGINE_SUBSTITUTION&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">./.data/mysql:/var/lib/mysql&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">./.docker/mysql/init:/docker-entrypoint-initdb.d&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;3306:3306&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">environment&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">MYSQL_ROOT_PASSWORD&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">root&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">MYSQL_DATABASE&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">database&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">MYSQL_USER&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">develop&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">MYSQL_PASSWORD&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">p@ssw0rd&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">TZ&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;Asia/Tokyo&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">schemaspy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">container_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">schemaspy&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">schemaspy/schemaspy:6.1.0&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">./schemaspy/output:/output&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">./schemaspy/meta:/meta&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">depends_on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">mysql&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">&amp;gt;&lt;/span>&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> java -jar schemaspy.jar
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> -t mysql
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> -dp /drivers
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> -host mysql
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> -port 3306
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> -db database
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> -u develop
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> -p p@ssw0rd
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> -s database
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> -meta /meta/schemameta.xml
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> -connprops useSSL\\=false&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="schemaspy-の起動オプション">SchemaSpy の起動オプション&lt;/h3>
&lt;ul>
&lt;li>&lt;code>-t&lt;/code> : データベース種別&lt;/li>
&lt;li>&lt;code>-dp&lt;/code> : ドライバーパス&lt;/li>
&lt;li>&lt;code>-host&lt;/code> : DBホスト&lt;/li>
&lt;li>&lt;code>-port&lt;/code> : ポート番号&lt;/li>
&lt;li>&lt;code>-db&lt;/code> : DB名&lt;/li>
&lt;li>&lt;code>-u&lt;/code> : ユーザ名&lt;/li>
&lt;li>&lt;code>-p&lt;/code> : パスワード&lt;/li>
&lt;li>&lt;code>-s&lt;/code> : スキーマ名&lt;/li>
&lt;li>&lt;code>-meta&lt;/code> : 手動でリレーションなどを連携するためのメタファイル（なければ不要&lt;/li>
&lt;/ul>
&lt;h2 id="実行">実行&lt;/h2>
&lt;p>Dockerを起動。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/docker.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Docker</category><category>DB</category><category>Docker</category></item><item><title>【DB】テーブルを簡単に一括削除する方法</title><link>https://c-a-p-engineer.github.io/tech/2021/12/28/db-drop-tables/</link><pubDate>Mon, 27 Dec 2021 01:30:00 +0900</pubDate><atom:modified>Mon, 27 Dec 2021 01:30:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2021/12/28/db-drop-tables/</guid><description>&lt;h1 id="dbテーブルを簡単に一括削除する方法">【DB】テーブルを簡単に一括削除する方法&lt;/h1>
&lt;p>データベースでテーブルを簡単に一括削除する方法&lt;/p>
&lt;h2 id="sql">SQL&lt;/h2>
&lt;h3 id="スキーマで一括削除">スキーマで一括削除&lt;/h3>
&lt;p>特定のスキーマのテーブルを全て削除します。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="k">drop&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">schema&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">public&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">cascade&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">create&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">schema&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">public&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>他のスキーマも消す場合はスキーマ毎に削除してください。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/db.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>DB</category><category>DB</category></item><item><title>【Python】SQLAlchemy where in 検索を行う</title><link>https://c-a-p-engineer.github.io/tech/2021/12/11/python-sqlalchemy-where-in/</link><pubDate>Sat, 11 Dec 2021 02:00:00 +0900</pubDate><atom:modified>Sat, 11 Dec 2021 02:00:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2021/12/11/python-sqlalchemy-where-in/</guid><description>&lt;h1 id="pythonsqlalchemy-where-in-検索を行う">【Python】SQLAlchemy where in 検索を行う&lt;/h1>
&lt;p>PythonのSQLAlchemyでwhere句のinの検索を行う方法。&lt;/p>
&lt;h2 id="失敗">失敗&lt;/h2>
&lt;p>SQLAlchemyで配列をinで検索するとエラーが出ます。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/python-logo-master-v3-TM.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Python</category><category>DB</category><category>PostgreSQL</category><category>Python</category></item><item><title>【Python】PostgreSQL使用時に文字列をエスケープする方法</title><link>https://c-a-p-engineer.github.io/tech/2021/12/11/python-psycopg2-escape/</link><pubDate>Sat, 11 Dec 2021 01:00:00 +0900</pubDate><atom:modified>Sat, 11 Dec 2021 01:00:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2021/12/11/python-psycopg2-escape/</guid><description>&lt;h1 id="pythonpostgresql使用時に文字列をエスケープする方法">【Python】PostgreSQL使用時に文字列をエスケープする方法&lt;/h1>
&lt;p>PythonでPostgreSQL使用時に文字列をエスケープする方法メモ&lt;/p>
&lt;h2 id="sqlエスケープ">SQLエスケープ&lt;/h2>
&lt;p>&lt;code>psycopg2&lt;/code> を使用します。&lt;/p>
&lt;p>&lt;code>psycopg2&lt;/code> を入れるには &lt;code>pip install psycopg2&lt;/code> でインストールが出来ます。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">psycopg2.extensions&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">adapt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># SQLエスケープ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">sql_escape&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 無名関数化&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">escape&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">lambda&lt;/span> &lt;span class="n">param&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">adapt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">str&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">encode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;utf-8&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">decode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;latin-1&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># リスト対応&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nb">isinstance&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">list&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">param&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">map&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">escape&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">param&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="s2">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">map&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">str&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">param&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 辞書型対応&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nb">isinstance&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">dict&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">param&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">map&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">escape&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">param&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34; , &amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">values&lt;/span>&lt;span class="p">()))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># その他&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">escape&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># エスケープ対象文字列&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">param&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34; &amp;#39; \ &amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># エスケープ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">string&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">str&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sql_escape&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 表示&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">string&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>出力結果&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/python-logo-master-v3-TM.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Python</category><category>DB</category><category>PostgreSQL</category><category>Python</category></item><item><title>【Mysql】テーブルバックアップ方法</title><link>https://c-a-p-engineer.github.io/tech/2021/10/13/mysql-table-backup/</link><pubDate>Wed, 13 Oct 2021 22:00:00 +0900</pubDate><atom:modified>Wed, 13 Oct 2021 22:00:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2021/10/13/mysql-table-backup/</guid><description>&lt;h1 id="mysqlテーブルバックアップ方法">Mysqlテーブルバックアップ方法&lt;/h1>
&lt;p>Mysql で簡単にテーブルのバックアップをする方法。&lt;br />
これさえ、あればテーブルのバックアップを簡単に取っておくことが出来ます。&lt;/p>
&lt;h2 id="サンプル">サンプル&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">-- テーブルの構造コピー
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">CREATE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">TABLE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">バックアップ先テーブル名&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">LIKE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">バックアップ元テーブル名&lt;/span>&lt;span class="p">];&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="c1">-- データコピー
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">INSERT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">INTO&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">バックアップ先テーブル名&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">SELECT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">FROM&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">バックアップ元テーブル名&lt;/span>&lt;span class="p">];&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="参考">参考&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://dev.mysql.com/doc/refman/8.0/ja/create-table-like.html" target="_blank" rel="nofollow noopener">MySQL :: MySQL 8.0 リファレンスマニュアル :: 13.1.20.3 CREATE TABLE &amp;hellip; LIKE ステートメント&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://dev.mysql.com/doc/refman/8.0/ja/insert-select.html" target="_blank" rel="nofollow noopener">MySQL :: MySQL 8.0 リファレンスマニュアル :: 13.2.6.1 INSERT &amp;hellip; SELECT ステートメント&lt;/a>&lt;/li>
&lt;/ul></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item><item><title>PHP で Database の Tableを丸ごとコピー</title><link>https://c-a-p-engineer.github.io/tech/2021/04/10/php-database-copy/</link><pubDate>Sat, 10 Apr 2021 10:00:00 +0900</pubDate><atom:modified>Sat, 10 Apr 2021 10:00:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2021/04/10/php-database-copy/</guid><description>&lt;h1 id="php-で-database-の-tableを丸ごとコピー">PHP で Database の Tableを丸ごとコピー&lt;/h1>
&lt;p>テストをする際にテスト用のDBを整備するのが面倒だったのでPHPでDatabaseのTable定義を使用してテーブルのコピーを作成するようにしました。&lt;br />
PHPUnitを使用する際など一々Databaseを整備する必要がなくなるのでとても有用で PHPUnit 実行前に行うと整備する手間がなくなります。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/php.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>PHP</category><category>DB</category><category>PHP</category></item><item><title>【Mysql】存在チェックINSERT文 重複行を挿入しない方法</title><link>https://c-a-p-engineer.github.io/tech/2021/02/23/mysql-exists-insert/</link><pubDate>Tue, 23 Feb 2021 08:00:00 +0900</pubDate><atom:modified>Tue, 23 Feb 2021 08:00:00 +0900</atom:modified><guid>https://c-a-p-engineer.github.io/tech/2021/02/23/mysql-exists-insert/</guid><description>&lt;h1 id="存在チェックinsert文-重複行を挿入しない方法">存在チェックINSERT文 重複行を挿入しない方法&lt;/h1>
&lt;p>データ登録時に同一データがある場合は一意制約違反でエラーが発生したり、重複を挿入したくない時のためのメモ。&lt;br />
挿入済みデータの存在チェックを行い、同一データの挿入を防ぎます。&lt;/p></description><dc:creator>こぴぺたん</dc:creator><media:content url="https://c-a-p-engineer.github.io/images/thumbnail/powered-by-mysql-167x86.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>Mysql</category><category>DB</category><category>Mysql</category></item></channel></rss>